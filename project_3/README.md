# PROJECT-3. EDA + Feature Engineering. Соревнование на Kaggle

## Оглавление
[1. Цели и суть проекта](#Цели-и-суть-проекта)

[2. Этапы проекта](#Этапы-проекта)

[3. “Подгрузка данных”](#Подгрузка-данных)

[4. “Исследование данных”](#Исследование-данных)

[5. “Обработка признаков”](#Обработка-признаков)

[6. “Кодирование признаков”](#Кодирование-признаков)

[7. “Отбор признаков”](#Отбор-признаков)

[8. “Обучение модели”](#Обучение-модели)

[9. Заключение](#Заключение)


-----
### **Цели и суть проекта**

*Проблема*:

Представьте, что вы работаете дата-сайентистом в компании Booking. Одна из проблем компании — это нечестные отели, которые накручивают себе рейтинг. Одним из способов обнаружения таких отелей является построение модели, которая предсказывает рейтинг отеля. Если предсказания модели сильно отличаются от фактического результата, то, возможно, отель ведёт себя нечестно, и его стоит проверить.

*Цель проекта*:

Подготовить данные для обучения модели, за счет чего улучшить параметр MAPE и получить более качественные выходные данные, генерируемые моделью.

*Задачи проекта*:

   - ознакомиться с входными данными (датасет с информацией об отелях);
   - изучить пример машинного обучения (scikit-learn класс RandomForestRegressor);
   - выполнить подготовку данных, которые будут использованы для обучения модели;
   - проверить эффективность предлагаемой модели, используя метрику MAPE;
   - принять участие в соревнованиях на площадке kaggle.com.

   
Выполнение подготовки данных сводится к таким действиям:

  - Удаление строковых значений.
  - Очистка от пропущенных значений.
  - Создание новых признаков.
  - Преобразование признаков.
  - Отбор признаков.




### **Этапы проекта:**

Наш проект включает в себя несколько этапов:

    -  подгрузка данных;
    -  исследование данных;
    -  обработка признаков;
    -  кодирование признаков;
    -  отбор признаков;
    -  обучение модели.


---
### **Подгрузка данных**

Перед началом работы необходимо подгрузить данные и убедиться, что все прошло успешно.
У нас есть 2 датасета с отзывами: train (тренировочный, с оценками) и test (тестовый, без оценок).

Эти два датасета мы склеим в один, чтобы можно было обрабатывать признаки сразу в двух датасетах.

Датасет содержит следующие признаки:

    hotel_address - адрес отеля
    review_date - дата, когда рецензент разместил соответствующий отзыв.
    average_score - средний балл отеля, рассчитанный на основе последнего комментария за последний год
    hotel_name - название отеля
    reviewer_nationality - национальность рецензента
    negative_review - отрицательный отзыв, который рецензент дал отелю.
    review_total_negative_word_counts - общее количество слов в отрицательном отзыв
    positive_review - положительный отзыв, который рецензент дал отелю
    review_total_positive_word_counts - общее количество слов в положительном отзыве
    reviewer_score - оценка, которую рецензент поставил отелю на основе своего опыта
    total_number_of_reviews_reviewer_has_given - количество отзывов, которые рецензенты дали в прошлом
    total_number_of_reviews - общее количество действительных отзывов об отеле
    tags - теги, которые рецензент дал отелю.
    days_since_review - продолжительность между датой оценки и датой выгрузки данных
    additional_number_of_scoring - есть также некоторые гости, которые просто поставили оценку сервису, а не оставили отзыв. Это число указывает, сколько там действительных оценок без проверки.
    lat - широта отеля
    lng - долгота отеля


### **Исследование данных**

На этом этапе необходимо поближе познакомиться с данными: 

- посмотреть структуру таблицы, 
- ее содержимое, 
- количество строк,
- количество пропусков,
- поискать дубликаты.

### **Обработка признаков**

На этом этапе происходит более глубокий анализ содержимого каждого признака. 

Все признаки можно разделить на такие группы:
- признаки, связанные с отелем,
- признаки, связанные с ревьювером,
- признаки, связанные с отзывами.

На этом этапе мы:
- заполним пропуски, 
- создадим новые признаки на основе имеющихся, а также подгрузим данные из общедоступных источников,
- проанализируем выбросы,
- посмотрим, как зависит оценка от различных факторов
и т.д.


### **Кодирование признаков**

У нас есть признаки типа object, которые нужно либо удалить, либо преобразовать к машинному типу - закодировать.

Приведем категориальные булевы признаки к числовому виду. А также применим однократное кодирование к тем категориальным признакам, количество значений которых не превышает 15, а бинарное - к остальным.


### **Отбор признаков**

На этом этапе данные исследуются на мультиколлениарность, а также проверяются на значимость.
Удаляются слабые признаки.

### **Обучение модели**

Прежде всего, для создания модели необходимо разделить датасет на набор данных, которые мы будем использовать для обучения модели, и на целевую переменную — величину, значение которой мы будем предсказывать (в нашем случае это рейтинг отелей).
Далее каждый из полученных наборов мы делим на тренировочный (train, используется для обучения модели) и тестовый (test, используется для оценки точности модели). Такое деление осуществляется с помощью специального метода train_test_split() библиотеки sklearn. 
Сам процесс создания и тестирования модели занимает всего четыре строчки кода. В качестве алгоритма мы будем использовать популярный и довольно мощный алгоритм RandomForestRegressor. Он реализован в библиотеке sklearn.

Для оценки качества модели — точности прогнозов, сделанных моделью, — мы будем использовать метрику (некий числовой показатель), которая называется MAPE (mean absolute percentage error), средняя абсолютная процентная ошибка.

----

### **Заключение**

В рамках данного проекта нужно было создать свою первую модель, основанную на алгоритмах машинного обучения.
И чтобы модель заработала, в неё нужно было передать подготовленные данные. Приведение данных к нужному виду и было нашей задачей в этом проекте, с которой мы успешно справились. Конечно же, с появлением новых знаний и опыта, а также располагая бОльшим количеством времени, эти данные можно будет улучшить и получить более качественный результат. Работа над проектом была очень полезна.





:arrow_up: [к оглавлению](https://github.com/TatyanaTmf/ds_game/tree/main/project_3/README.md#Оглавление)
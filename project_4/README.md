# PROJECT-4. Решение задачи классификации

## Оглавление
[1. Цели и суть проекта](#Цели-и-суть-проекта)

[2. Этапы проекта](#Этапы-проекта)

[3. “Первичная обработка данных”](#Первичная-обработка-данных)

[4. “Разведывательный анализ данных”](#Разведывательный-анализ-данных)

[5. “Преобразование данных”](#Преобразование-данных)

[6. “Решение задачи классификации: логистическая регрессия и решающие деревья”](#Решение-задачи-классификации:-логистическая-регрессия-и-решающие-деревья)

[7. “Решение задачи классификации: ансамбли моделей и построение прогноза”](#Решение-задачи-классификации:-ансамбли-моделей-и-построение-прогноза)

[8. “Выводы”](#Выводы)

[9. Заключение](#Заключение)


-----
### **Цели и суть проекта**

*Проблема*:

Вам предстоит решить настоящую задачу, которая часто встаёт перед аналитиками, работающими в банковском секторе.

Банки хранят огромные объёмы информации о своих клиентах. Эти данные можно использовать для того, чтобы оставаться на связи с клиентами и индивидуально ориентировать их на подходящие именно им продукты или банковские предложения.

Обычно с выбранными клиентами связываются напрямую через разные каналы связи: лично (например, при визите в банк), по телефону, по электронной почте, в мессенджерах и так далее. Этот вид маркетинга называется прямым маркетингом. На самом деле, прямой маркетинг используется для взаимодействия с клиентами в большинстве банков и страховых компаний. Но, разумеется, проведение маркетинговых кампаний и взаимодействие с клиентами — это трудозатратно и дорого.

Банкам хотелось бы уметь выбирать среди своих клиентов именно тех, которые с наибольшей вероятностью воспользуются тем или иным предложением, и связываться именно с ними.

Вам предоставили данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Вы должны проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк. Если вы сможете это сделать, то поднимете доходы банка и поможете понять целевую аудиторию, которую необходимо привлекать путём рекламы и различных предложений.


*Бизнес-задача*: определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

*Техническая задача для специалиста в Data Science*: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.


*Основные цели*:

        Исследуйте данные, а не просто вычисляйте метрики и создавайте визуализации.
        Попробуйте выявить характерные черты для потенциальных клиентов, чтобы чётко очертить ЦА и увеличить прибыль банка.
        Проявляйте фантазию и используйте разные инструменты для повышения качества прогноза.

   
### **Этапы проекта:**

*Проект будет состоять из пяти частей:*

1. Первичная обработка данных.
В рамках этой части вам предстоит обработать пропуски и выбросы в данных. Это необходимо для дальнейшей работы с ними.

2. Разведывательный анализ данных (EDA).
Вам необходимо будет исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.

3. Отбор и преобразование признаков.
На этом этапе вы перекодируете и преобразуете данные таким образом, чтобы их можно было использовать при решении задачи классификации. Если на первом этапе вы лишь избавите данные от ненужных артефактов, то на этом шаге совершите действия, более важные для подготовки данных к задаче классификации, уже понимая их структуру.

4. Решение задачи классификации: логистическая регрессия и решающие деревья.
На данном этапе вы построите свою первую прогностическую модель и оцените её качество. Вы научитесь подбирать оптимальные параметры модели для того, чтобы получить наилучший результат для конкретного алгоритма.

5. Решение задачи классификации: ансамбли моделей и построение прогноза.
На заключительном этапе вы сможете доработать своё предсказание с использованием более сложных алгоритмов и оценить, с помощью какой модели возможно сделать более качественные прогнозы.


---
### **Первичная обработка данных**

На этом этапе необходимо поближе познакомиться с данными: 

- посмотреть структуру таблицы, 
- ее содержимое, 
- количество строк,
- количество пропусков,
- поискать дубликаты,
- обработать выбросы.

Перед началом работы необходимо подгрузить данные и убедиться, что все прошло успешно.

Какие данные нам предоставили, чтобы мы могли выявить решающие факторы для успеха маркетинговой кампании? В целом их можно разделить на несколько групп.

Данные о клиентах банка:

        age (возраст);
        job (сфера занятости);
        marital (семейное положение);
        education (уровень образования);
        default (имеется ли просроченный кредит);
        housing (имеется ли кредит на жильё);
        loan (имеется ли кредит на личные нужды);
        balance (баланс).

Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:

        contact (тип контакта с клиентом);
        month (месяц, в котором был последний контакт);
        day (день, в который был последний контакт);
        duration (продолжительность контакта в секундах).

Прочие признаки:

        campaign (количество контактов с этим клиентом в течение текущей кампании);
        pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
        previous (количество контактов до текущей кампании)
        poutcome (результат прошлой маркетинговой кампании).

И, разумеется, наша целевая переменная deposit, которая определяет, согласится ли клиент открыть депозит в банке. Именно её мы будем пытаться предсказать в данном кейсе.


### **Разведывательный анализ данных**

В данной части проекта вам необходимо будет:

        исследовать данные;
        попробовать найти закономерности, позволяющие сформулировать предварительные гипотезы относительно того, какие факторы являются решающими для оформления депозита;
        дополнить ваш анализ визуализациями, иллюстрирующими ваше исследование. 


### **Преобразование данных**

Перед тем как перейти к построению модели, осталось сделать ещё один шаг.

 Следует помнить, что алгоритмы машинного обучения не могут обрабатывать категориальные признаки в их обычном виде. По ходу работы алгоритм считает показатели (например, средние значения), которые можно вычислить только для количественных признаков. 
 Поэтому нам необходимо:
- преобразовать категориальные признаки в более удобный формат;
- масштабировать и трансформировать некоторые признаки для того, чтобы улучшить качество модели;
- отобрать признаки, которые мы будем использовать для обучения модели.


### **Решение задачи классификации: логистическая регрессия и решающие деревья**

На этом этапе мы решим задачу классификации: отоберем признаки, обучим модель, сделаем прогноз и оценим его качество.

Реализуем самый простой алгоритм, который нам известен — логистическую регрессию, потом обучим ещё один алгоритм — решающие деревья.
Переберем различные максимальные глубины деревьев и найдем глубину дерева, для которой будет максимальное значение метрики accuracy, но при этом ещё не будет наблюдаться переобучения. Реализуем оптимизацию гиперпараметров с помощью GridSearch.

### **Решение задачи классификации: ансамбли моделей и построение прогноза**

Мы уже смогли обучить несложные модели, и теперь пришло время усложнить их, а также посмотреть, улучшится ли результат (если да, то насколько). Мы обучили решающие деревья, и теперь пришла пора объединить их в случайный лес. Для оптимизации гиперпараметров применим Optuna.


### **Выводы**

Подведем итоги наших исследований и посмотрим на результаты обученных в ходе работы алгоритмов .


----
### **Заключение**

Вы справились с настоящим проектом, решив достаточно сложную, но важную и популярную в индустрии задачу. Теперь вы можете решить полноценную задачу классификации, начиная от предобработки данных и заканчивая оценкой качества построенных моделей и отбора наиболее значимых предикторов.

Это лишь один из возможных вариантов решения поставленной задачи. Вы можете попробовать улучшить качество предсказания, используя более продвинутые подходы для удаления выбросов или беря больше признаков. Вы можете создать бόльшую сетку параметров для отбора оптимизацией или использовать новые алгоритмы, не рассматриваемые в курсе. 

В будущем, когда вы познакомитесь с другими методами, вы сможете доработать эту задачу и, возможно, получить еще более высокий результат.



:arrow_up: [к оглавлению](https://github.com/TatyanaTmf/ds_game/tree/main/project_4/README.md#Оглавление)